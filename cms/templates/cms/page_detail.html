{% extends 'base.html' %}

{% block title %}
  {{ page.title }}
{% endblock %}

{% block content %}
  {% if alter_URL %}
    <script>
      history.replaceState(
        null,
        '{{ page.title }}',
        '{{ page.get_absolute_url }}')
    </script>
  {% endif %}

  <header>
    <nav>
      {% include 'cms/partials/breadcrumbs.html' with breadcrumbs=breadcrumbs %}
    </nav>

    {% if request.user.is_staff %}
      <nav>
        <a href="{% url 'cms:add_page' %}?from={{ page.id }}">Add page</a>
      </nav>
    {% endif %}

    <h1>{{ page.title }}</h1>
  </header>

  <main>
    <nav class='sidebar'>
    </nav>

    <article class='content'>
      <aside class='table-of-contents'>
        {% include 'cms/partials/table_of_contents.html' with blocks=page.blocks.all %}
      </aside>

      {% for block in page.blocks.all %}
        {% include block.template_name with block=block %}
      {% endfor %}
    </article>
  </main>
{% endblock %}
